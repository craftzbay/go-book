# Функц

Функц нь тодорхой зорилго бүхий кодын хэсгүүдийг нэгтгэж бүлэглэн нэр оноож, олон дахин дуудаж ашиглах боломжийг олгоно.

Функцүүд төрөл бүрийн  зориулалттай байдаг.  Жишээ нь `main()`, `println()` зэрэг нь функцүүд юм. `println()` нь мэдээллийг компютерийн дэлгэцэнд хэвлэж гаргана.

`main()` функц нь програм эхлэхэд хамгийн эхэнд дуудагдах тусгай функц юм. Бусад функцүүд шууд болон шууд бусаар энэ функцээс дуудагдана.

## Функц тодорхойлох

Функц тодорхойлохдоо түүний нэр, хүлээн авах параметрүүд, буцаах утгын төрлийг бичнэ.

Жишээ нь 3 ширхэг гурвалжны талбайг тооцоолж олох програм бичиж байна гэж бодоё. Тэгвэл талбай бодох томъёог 3 удаа бичиж болно, эсвэл түүнд зориулан функц бичиж болно.

```go
// triangle – Гурвалжны талбай бодох
func triangle(width float32, height float32) float32 {
    area:= width * height / 2.0
    return area
}
```

## Параметр ба буцах утга

Go нь параметрийг функцэд дамжуулахдаа “утгаар дамжуулах” гэж нэрлэгдэх аргыг ашиглана. Тухайлбал,  `triangle` функцийг дараах байдлаар дуудна:

```go
triangle(1.3, 8.3)
```

Энэ үед Go нь дамжуулсан утгуудыг \(`1.3` ба `8.3`\) харгалзах аргументууд рүү \(`width` ба `height`\) хуулаад биелүүлж эхэлдэг.

> “параметр” ба “аргумент” гэсэн ойлголтуудыг ихэнх тохиолдолд адилхан хэрэглэдэг, гэхдээ аргументыг тодорхойлдог, параметрыг функцэд дамжуулдаг өгөгдөл болохыг ялгаж ойлгох хэрэгтэй.

Хэрэв функцүүдийг барилгын өрөөнүүд гэж үзвэл аргументууд нь тэдгээрийн хоорондох хаалганууд юм. Жишээ нь `1.3` утга нь `trianlge` өрөөний `width` гэж тэмдэглэгдсэн хаалгаар, `8.3` нь `height` нэртэй хаалгаар орж байна гэж төсөөлж болно.

Эдгээр хаалга нь нэг чиглэлтэй, өөрөөр хэлбэл эдгээр хаалгаар орж болно, харин гарч чадахгүй. Ордог бас гардаг “хаалганы” тухай бид заагч бүлэгт үзэх болно.

`triangle` функц нь дараах заавраар талбайг тооцоолж олно:

```go
area = width * height / 2.0
```

Зүүн талын area хувьсагчийн утга нь дуудагчид буцаан дамжуулах утга юм. Үүнийг `return` заавраар гүйцэтгэнэ:

```go
return area
```

Одоо функцийг яаж үндсэн функцэд \(дуудагч\) ашиглахыг харая:

```go
func main() {
  fmt.Printf("Triangle #1 %f\n", triangle(1.3, 8.3))
  fmt.Printf("Triangle #2 %f\n", triangle(4.8, 9.8))
  fmt.Printf("Triangle #3 %f\n", triangle(1.2, 2.0))
}
```

Функц нь хэчнээн ч тооны параметртэй байж болно, байхгүй ч байж болно. Параметргүй байсан ч функц дуудахдаа хаалт хэрэглэх ёстой:

```go
value = next_index()
```

## Олон утга буцаах

Функцээс олон утга буцааж болдог Go хэлний нэг өвөрмөц онцлог юм.

```go
package main
import "fmt"

func swap(x, y string) (string, string) {
    return y, x
}

func main() {
    a, b := swap("hello", "world")
    fmt.Println(a, b)
}
```

## Буцах утгыг нэрлэх

Go хэлэнд функцийн буцах утгыг нэрлэх боломж олгодог. Буцах утгыг нэрлэснээр кодон дотроо тэдгээрийг ашиглах боломжтой болгодог. Нэгэнт буцах утгыг кодын явцад оноосон учраас функцийн төгсгөлд `return` зааварт дурдах шаардлагагүй байдаг. Гэхдээ `return` зааврыг заавал бичих хэрэгтэй.

```go
package main
import "fmt"

func split(sum int) (x, y int) {
    // x, y нэртэй буцах утгуудыг функц дотор ашиглаж байна
    x = sum * 4 / 9
    y = sum - x
    return
}

func main() {
    fmt.Println(split(17))
}
```

## Хувьсах тооны параметр

Go функцийг хувьсах тооны параметртэй дуудах боломжтой. Хувьсах тооны параметр авдаг функцүүдийн нэг бол бидний сайн мэдэх `fmt.Printf()` функц юм. Энэ функц нь заавал шаардах нэг аргументтай байдаг, түүний араас хувьсах тооны  аргумент бичдэг.

```go
fmt.Printf(fmt, ...)
```

Хувьсах тооны аргументтай функц үүсгэхийн тулд функцийн зарлалтад `...` тэмдэглэгээг хийнэ. Энэ тэмдэглэгээ нь хэдэн ч аргумент авч болно гэдгийг илэрхийлнэ.

```go
package main

func Greeting(prefix string, who ...string) {
  print(prefix, " ")
  for i:=0; i<len(who); i++ {
   print(who[i], " ")
  }
  println()
}

func main() {
 Greeting("Сайн уу", "Сараа", "Нараа")
}
```

Дээрх `Greeting()` функцэд мөн массив дамжуулж болно. Энэ тохиолдолд массивын ард мөн `…` тэмдэглэгээ хийнэ.

```go
s := []string{"Сараа", "Нараа","Навчаа", "Цэцгээ"}
Greeting("Баяртай ", s...)
```

## main\(\) функц

Бид `main()` функийн тухай өмнө үзсэн. Энэ нь програм эхлэх үед дуудагддаг тусгай функц юм. Бусад бүх функцүүд шууд болон шууд бусаар `main()` функцээс дуудагддаг.

`main()` функцэд терминалаас өгөгдөл дамжуулах боломжтой. Жишээ нь `args` нэртэй програмд “one”, ”two”, “and three” гэсэн 3 параметр дамжуулах бол дараах байдлаар бичнэ.

```sh
$ ./args one two "and three"
```

Эдгээр дамжуулсан параметрүүдийг `os.Args` массиваар дамжуулан уншиж болно. Энэ массивын эхний элемент `Args[0]` нь дуудагдсан програмын нэрийг агуулна. Түүнээс хойш утгууд нь командын мөрнөөс дамжуулсан параметрүүдийг агуулна.

Дараах жишээ програмд командын мөрнөөс дамжуулсан параметрүүдийг хэвлэн харуулав.

```go
package main

import (
  "fmt"
  "os"
)

func main() {
    for i:=1; i<len(os.Args); i++ {
      fmt.Println(os.Args[i])
    }
}
```

Програмыг ажиллуулвал үр дүн дараах байдалтай харагдана:

```sh
$ ./args one two "and three"
one
two
and three
```

Командын мөрөөс дамжуулсан параметр \(эсвэл тохируулга\) уншихад зориулсан `flag` нэртэй сан байдаг.

Жишээ нь `max` нэртэй тохируулгыг `myflag` програмд дамжуулах бол дараах байдлаар дуудна:

```sh
$ ./myflag  -max=100
```

Програмын эх кодыг доор харуулав:

```go
package main

import (
  "fmt"
  "flag"
  "math/rand"
)

func main() {
  // флаг тодорхойлох
  maxp := flag.Int("max", 6, "the max value")
  // задалж унших
  flag.Parse()

  // флагт дамжуулсан утгыг ашиглах
  fmt.Println(rand.Intn(*maxp))
}
```

## Рекурсив функц

Өөрөө өөрийгөө шууд эсвэл шууд бусаар дууддаг функцийг _рекурсив_ функц гэнэ. Тооны факториал олох зэрэг рекурсив математик томъёололууд нь програмчлалын хэлэнд рекурсив функцээр шийдэгддэг.

Факториалын томъёо:

```
fact(0) = 1
fact(n) = n * fact(n-1)
```

Go хэлэнд энэ томъёо нь:

```go
func fact(number int) int {
  if number == 0 {
    return (1)
  }
  return number * fact(number-1)
}
```

Рекурсив функц нь дараах 2 үндсэн дүрмийг мөрдөх ёстой:

* рекурсив функц нь төгсдөг байх ёстой;
* асуудлыг энгийн болгох ёстой.

Дээрх `fact()` функц нь энэхүү 2 дүрмийг хангасан байна. Нэгд, `number == 0` болох төгсөх нөхцөлтэй байна.  Хоёрт, асуудлыг энгийнээр шийдсэн байна.

Факториал нь зөвхөн `number >= 0` үед бодогдоно. Хэрэв `fact(-3)`-г тооцоолохыг оролдвол юу болох вэ?  Стек дүүрэлт болж програм хэвийн бус тасрах болно, учир нь  `fact(-3)` нь `fact(-4)`-г дуудна, цаашаа `fact(-5)`-г дуудна гэх мэт дуусахгүй үргэлжилнэ. Үүнийг төгсгөлгүй рекурсийн алдаа гэж нэрлэдэг.

Давтаж тооцоолох олон зүйлсийг рекурсээр шийдэж болно. Жишээ нь, массивын элементүүдийг рекурсивээр нэмж нийлбэрийг олж болно. Нэмэх дүрмээ дараах байдлаар томёолж болно:

```
sum(a[x]) = x
sum(a[x, ...]) = a[0] + sum(a[1:])
```

Go-д энэ функцийг буулгавал:

```go
func sum(a []int) int {
  if len(a) == 1 {
    return a[0]
  }
  return a[0] + sum(a[1:])
}
```

Програм яаж ажиллахыг жишээлэн харуулвал:

```
sum(1 8 3 2) =
    1 + sum(8 3 2) =
        8 + sum(3 2) =
            3 + sum(2) =
                2
            3 + 2 = 5
        8 + 5 = 13
    1 + 13 = 14
Хариу = 14
```

## Функц доторхи функц

TODO: clojure

